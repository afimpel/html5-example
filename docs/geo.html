<!DOCTYPE html>
<html>
<head>
    <title>JavaScript Geolocation API</title>
</head>

<body style="font-size: 24px; text-align: center; padding: 1rem;">
    <h1 style="border: 1px solid green; padding: 1rem;">JavaScript Geolocation API</h1>
    <button style="font-size: 72px; color: green; padding: 1rem 6rem;" onclick="getLocation()">Click</button>

    <pre style="border: 1px solid green; padding: 1rem;" id="demo">33333</pre>

    <script>
        const x = document.getElementById("demo");

        function getLocation() {
            x.innerHTML = new Date();
            x.innerHTML += "<hr />";
            if (navigator.geolocation) {
                x.innerHTML += "navigator.geolocation";
                navigator.geolocation.getCurrentPosition(showPosition);
            }
            x.innerHTML += "<hr />";
            if (navigator.permissions) {
                x.innerHTML += "navigator.permissions";
                navigator.permissions
                    .query({
                        name: "geolocation",
                    })
                    .then((permission) => {
                        x.innerHTML += "<br /><b>" + permission.state+"</b>";
                        if (permission.state === "granted") {
                            x.innerHTML += "<br />La geolocalización está permitida.";
                        } else if (permission.state === "prompt") {
                            x.innerHTML +=
                                "El usuario debe otorgar permiso para la geolocalización.";
                            navigator.geolocation.getCurrentPosition(showPosition);
                        } else {
                            x.innerHTML += "<br />La geolocalización está denegada.";
                        }
                        x.innerHTML += "<hr />";
                    });
            } else {
                x.innerHTML += "<br />El navegador no admite la API Permissions.";
            }
        }

        x.innerHTML = new Date();
        getLocation();

        function showPosition(position) {
            x.innerHTML += "<em style='color: green;'>"+position.timestamp +
                "</em><br />Latitude: <b>" +
                position.coords.latitude +
                "</b><br />Longitude: <b>" +
                position.coords.longitude +"</b>";
        }
    </script>
</body>

</html>
